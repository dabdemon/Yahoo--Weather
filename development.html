<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1'>
        <link rel='stylesheet' href='http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.css' />
        <script src='http://code.jquery.com/jquery-1.9.1.min.js'></script>
        <script src='http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js'></script>
        <style>
            .ui-header .ui-title { margin-left: 1em; margin-right: 1em; text-overflow: clip; }
            /*.ui-radio { width: 50%; }*/
        </style>
    </head>
    <body>
        <div data-role='page' id='main'>
            <div data-role='header' class='jqm-header' data-theme='b'>
                <IMG SRC="http://imagizer.imageshack.us/v2/320x240q90/546/5tp4.png">
                    </div>
                <div data-role='content'>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                        <input type="hidden" name="cmd" value="_xclick">
                        <input type="hidden" name="business" value="yweather.pebble@gmail.com">
                        <input type="hidden" name="lc" value="US">
                        <input type="hidden" name="item_name" value="YWeather">
                        <input type="hidden" name="button_subtype" value="services">
                        <input type="hidden" name="no_note" value="0">
                        <input type="hidden" name="currency_code" value="EUR">
                        <input type="hidden" name="tax_rate" value="0.000">
                        <input type="hidden" name="shipping" value="0.00">
                        <input type="hidden" name="bn" value="PP-BuyNowBF:btn_paynowCC_LG.gif:NonHostedGuest">
                        <input type="hidden" name="on0" value="USER ID">
                        <input type="hidden" name="os0" id="os0">

                        <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynowCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                        <img alt="" border="0" src="https://www.paypalobjects.com/es_ES/i/scr/pixel.gif" width="1" height="1">
                    </form>
                    User ID
                    <input name="UUID" id="UUID">

                    <div data-role="fieldcontain">
                        <label for="key">User Key</label>
                        <input type="text" name="key" id="key" value=" " />
                    </div>
                    <div data-role="fieldcontain">
                        <label for="language">Language</label>
                        <select name="language" id="language" data-theme="c" data-track-theme="d">
                            <option value="11">Catalan</option>
                            <option value="99">Chinese</option>
                            <option value="3">Czech</option>
                            <option value="10">Danish</option>
                            <option value="7">Dutch</option>
                            <option value="100">English (U.S.)</option>
                            <option value="97">English (Non-U.S.)</option>
                            <option value="6">Finnish</option>
                            <option value="4">French</option>
                            <option value="2">German</option>
                            <option value="12">Hungarian</option>
                            <option value="1">Italian</option>
                            <option value="98">Japanese</option>
                            <option value="13">Norwegian</option>
                            <option value="8">Polish</option>
                            <option value="5">Portuguese</option>
                            <option value="16">Romanian</option>
                            <option value="15">Slovak</option>
                            <option value="0">Spanish</option>
                            <option value="9">Swedish</option>
                            <option value="14">Turkish</option>
                        </select>
                    </div>
                    <div data-role="fieldcontain">
                        <label for="font">Theme</label>
                        <select name="font" id="font" data-theme="c" data-track-theme="d">
                            <option value="0">Classic</option>
                            <option value="1">Simple</option>
                            <option value="2">Childhood</option>
                        </select>
                    </div>
                    <div data-role="fieldcontain">
                        <label for="gps_switch">Use GPS</label>
                        <select name="gps_switch" id="gps_switch" data-theme="c" data-role="slider" data-track-theme="d">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                    <div data-role="fieldcontain">
                        <label for="location">Location</label>
                        <input type="text" name="location" id="location" value="" />
                    </div>
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup" data-type="horizontal">
                            <legend>Units:</legend>
                            <label for="celsius">Metric</label>
                            <input type="radio" id="celsius" name="units" value="celsius" data-theme="c">
                            <label for="fahrenheit">Imperial</label>
                            <input type="radio" id="fahrenheit" name="units" value="fahrenheit" data-theme="c">
                        </fieldset>
                    </div>
                    <div data-role="fieldcontain">
                        <label for="invert_color">Invert Colors</label>
                        <select name="invert_color" id="invert_color" data-theme="c" data-role="slider" data-track-theme="d">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                    <div data-role="fieldcontain">
                        <label for="hide_bat">Display Battery Level</label>
                        <select name="hide_bat" id="hide_bat" data-theme="c" data-role="slider" data-track-theme="d">
                            <option value="false">Low Batt</option>
                            <option value="true">Always</option>
                        </select>
                    </div>
                    <div data-role="fieldcontain">
                        <label for="vibes">Vibes on disconnect</label>
                        <select name="vibes" id="vibes" data-theme="c" data-role="slider" data-track-theme="d">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                    *NOTE: You need to reload YWeather to display/hide seconds.
                    <div data-role="fieldcontain">
                        <label for="seconds">Display Seconds</label>
                        <select name="seconds" id="seconds" data-theme="c" data-role="slider" data-track-theme="d">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                    <div data-role="fieldcontain">
                        <label for="hourly_vibe">Hourly Vibe</label>
                        <select name="hourly_vibe" id="hourly_vibe" data-theme="c" data-role="slider" data-track-theme="d">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                    <div data-role="fieldcontain">
                        <label for="alerts">Display YWeather alerts</label>
                        <select name="alerts" id="alerts" data-theme="c" data-role="slider" data-track-theme="d">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                    <h1>EXTRA FEATURES (For backers only)</h1>
                    <div data-role="content">
                        <label for="lt"></label>
                        <input type="text" name="lt" id="lt" value="" />
                    </div>
                    <h3>If you support with 1€ or more, you unlock:</h3>
                    <div data-role="fieldcontain">
                        <label for="feelslike">Display Feels Like (instead of real temperature)</label>
                        <select name="feelslike" id="feelslike" data-theme="c" data-role="slider" data-track-theme="d">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                    <div data-role="fieldcontain">
                        <label for="ESDuration">Extended screen duration</label>
                        <select name="ESDuration" id="ESDuration" data-theme="c" data-track-theme="d">
                            <option value="0">Off - No forecast</option>
                            <option value="5">5 seconds</option>
                            <option value="8">8 seconds</option>
                            <option value="10">10 seconds</option>
                            <option value="15">15 seconds</option>
                        </select>
                    </div>
                    
                    <div data-role="fieldcontain">
                        <label for="wspeed">Wind Speed Unit</label>
                        <select name="wspeed" id="wspeed" data-theme="c" data-track-theme="d">
                            <option value="0">km/h - mi/h</option>
                            <option value="1">m/s</option>
                            <option value="2">knots</option>
                            <option value="3">beaufort</option>
                        </select>
                    </div>
                    

                    <div data-role="fieldcontain">
                        <label for="donotdisturb">Hourly Vibe Quiet Hours</label>
                         <fieldset class='ui-grid-a'>
                            <div class='ui-block-a'>
                               <select name="start" id="start" data-role="time">
                                    <option value="0">0:00 (12:00am)</option>
                                    <option value="1">1:00 (1:00am)</option>
                                    <option value="2">2:00 (2:00am)</option>
                                    <option value="3">3:00 (3:00am)</option>
                                    <option value="4">4:00 (4:00am)</option>
                                    <option value="5">5:00 (5:00am)</option>
                                    <option value="6">6:00 (6:00am)</option>
                                    <option value="7">7:00 (7:00am)</option>
                                    <option value="8">8:00 (8:00am)</option>
                                    <option value="9">9:00 (9:00am)</option>
                                    <option value="10">10:00 (10:00am)</option>
                                    <option value="11">11:00 (11:00am)</option>
                                    <option value="12">12:00 (12:00pm)</option>
                                    <option value="12">13:00 (1:00pm)</option>
                                    <option value="14">14:00 (2:00pm)</option>
                                    <option value="15">15:00 (3:00pm)</option>
                                    <option value="16">16:00 (4:00pm)</option>
                                    <option value="17">17:00 (5:00pm)</option>
                                    <option value="18">18:00 (6:00pm)</option>
                                    <option value="19">19:00 (7:00pm)</option>
                                    <option value="20">20:00 (8:00pm)</option>
                                    <option value="21">21:00 (9:00pm)</option>
                                    <option value="22">22:00 (10:00pm)</option>
                                    <option value="23">23:00 (11:00pm)</option>
                                </select>
                            </div>
                            <div class='ui-block-b'>
                                <select name="end" id="end" data-role="time">
                                    <option value="0">0:00 (12:00am)</option>
                                    <option value="1">1:00 (1:00am)</option>
                                    <option value="2">2:00 (2:00am)</option>
                                    <option value="3">3:00 (3:00am)</option>
                                    <option value="4">4:00 (4:00am)</option>
                                    <option value="5">5:00 (5:00am)</option>
                                    <option value="6">6:00 (6:00am)</option>
                                    <option value="7">7:00 (7:00am)</option>
                                    <option value="8">8:00 (8:00am)</option>
                                    <option value="9">9:00 (9:00am)</option>
                                    <option value="10">10:00 (10:00am)</option>
                                    <option value="11">11:00 (11:00am)</option>
                                    <option value="12">12:00 (12:00pm)</option>
                                    <option value="12">13:00 (1:00pm)</option>
                                    <option value="14">14:00 (2:00pm)</option>
                                    <option value="15">15:00 (3:00pm)</option>
                                    <option value="16">16:00 (4:00pm)</option>
                                    <option value="17">17:00 (5:00pm)</option>
                                    <option value="18">18:00 (6:00pm)</option>
                                    <option value="19">19:00 (7:00pm)</option>
                                    <option value="20">20:00 (8:00pm)</option>
                                    <option value="21">21:00 (9:00pm)</option>
                                    <option value="22">22:00 (10:00pm)</option>
                                    <option value="23">23:00 (11:00pm)</option>
                                </select>
                            </div>
                        </fieldset>
                        <div data-role="time">

                        </div>
                    </div>
                    <h3>If you support with 3€ or more, you unlock:</h3>
                    <div data-role="fieldcontain">
                        <label for="accuracy">Weather Accuracy</label>
                        <select name="accuracy" id="accuracy" data-theme="c" data-track-theme="d">
                            <option value="16">Neighborhood</option>
                            <option value="11">City</option>
                            <option value="6">Region</option>
                        </select>
                    </div>
                    <div data-role="fieldcontain">
                        <label for="timer">Weather updates every</label>
                        <select name="timer" id="timer" data-theme="c" data-track-theme="d">
                            <option value="5">5 minutes</option>
                            <option value="15">15 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="45">45 minutes</option>
                            <option value="60">60 minutes</option>
                        </select>
                    </div>
                    <h3>If you support with 5€ or more, you unlock:</h3>
                    *NOTE: Triple shake your watch to display the extended weather info!
                    <div data-role="fieldcontain">
                        <label for="forecast">Display 3 day forecast</label>
                        <select name="forecast" id="forecast" data-theme="c" data-role="slider" data-track-theme="d">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                     <div data-role="fieldcontain">
                        <label for="weatherprovider">Language</label>
                        <select name="weatherprovider" id="weatherprovider" data-theme="c" data-track-theme="d">
                            <option value="0">Yahoo! Weather</option>
                            <option value="1">The Weather Underground</option>
                        </select>
                    </div>
                    <div class='ui-body ui-body-b'>
                        <fieldset class='ui-grid-a'>
                            <div class='ui-block-a'><button type='submit' data-theme='d' id='b-cancel'>Cancel</button></div>
                            <div class='ui-block-b'><button type='submit' data-theme='b' id='b-submit'>Submit</button></div>
                        </fieldset>
                    </div>
                    This settings page is compatible with YWeather v2.3 or higher
                </div>
            </div>
            <script>
                /*
                $("#units").change(function() {
                    fillWindSpeed(getQueryVariable("#units"));
                });

                function fillWindSpeed(units){
                    //first remove all the existing values (if any)
                     $('#wspeed').empty();
                    //Dynamically set the mi/h or km/h
                    if(units=="c"){$('#wspeed').append(new Option('km/h', '0'));}
                    else{   $('#wspeed').append(new Option('mi/h', '0'));}
                    //Finally set the static values
                    $('#wspeed').append(new Option('m/s', '1'));
                    $('#wspeed').append(new Option('knots', '2'));
                    $('#wspeed').append(new Option('beaufort', '3'));

                }
                */
                
                function getQueryVariable(variable) {
                    var query = location.search.substring(1);
                    var vars = query.split('&');
                    for (var i = 0; i < vars.length; i++) {
                        var pair = vars[i].split('=');
                        if (pair[0] == variable)
                            return decodeURIComponent(pair[1]);
                    }
                    return false;
                }
                function saveOptions() {
                    var options = {
                        'language': $('#language').val(),
                        'font': $('#font').val(),
                        'use_gps': $('#gps_switch').val(),
                        'location': $('#location').val(),
                        'units': $('input:radio[name=units]:checked').val(),
                        'invert_color': $('#invert_color').val(),
                        'vibes': $('#vibes').val(),
                        'accuracy': $('#accuracy').val(),
                        'feelslike': $('#feelslike').val(),
                        'ESDuration': $('#ESDuration').val(),
                        'beaufort': $('#wspeed').val(),
                        'start': $('#start').val(),
                        'end': $('#end').val(),
                        'timer': $('#timer').val(),
                        'UUID': $('#UUID').val(),
                        'lt': $('#lt').val(),
                        'key': $('#key').val(),
                        'forecast': $('#forecast').val(),
                        'seconds': $('#seconds').val(),
                        'hourly_vibe': $('#hourly_vibe').val(),
                        'alerts': $('#alerts').val(),
                        'weatherprovider': $('#weatherprovider').val(),
                        'hide_bat': $('#hide_bat').val(),
                        'version' : "2.5"
                    }
                    return options;
                }
                $().ready(function() {
                    

                    
        
                    
                    //Fill the Wind Speed options
                     //fillWindSpeed(getQueryVariable("#units"));
                    //Disable the UUID. this is merely informational
                    //$('#UUID').prop('disabled', true);
                    $('#lt').prop('disabled', true);
                    $("#lt").hide();
                    //Disable all the Extra Features to enable them based on LT
                    $('#accuracy').prop('disabled', true);
                    $('#feelslike').prop('disabled', true);
                    $('#ESDuration').prop('disabled', true);
                    $('#timer').prop('disabled', true);
                    $('#wspeed').prop('disabled', true);
                    $('#start').prop('disabled', true);
                    $('#end').prop('disabled', true);
                    $('#forecast').prop('disabled', true);
                    $('#weatherprovider').prop('disabled', true);
                    //Enable LT 1 fields
                    if (getQueryVariable('lt') == "1") {
                        $('#feelslike').prop('disabled', false);
                        $('#ESDuration').prop('disabled', false);
                        $('#wspeed').prop('disabled', false);
                        $('#start').prop('disabled', false);
                        $('#end').prop('disabled', false);
                    }
                    //Enable LT 2 fields
                    if (getQueryVariable('lt') == "2") {
                        $('#feelslike').prop('disabled', false);
                        $('#ESDuration').prop('disabled', false);
                        $('#wspeed').prop('disabled', false);
                        $('#start').prop('disabled', false);
                        $('#end').prop('disabled', false);
                        $('#accuracy').prop('disabled', false);
                        $('#timer').prop('disabled', false);
                    }
                    //Enable LT 3 fields
                    if (getQueryVariable('lt') == "3") {
                        $('#feelslike').prop('disabled', false);
                        $('#ESDuration').prop('disabled', false);
                        $('#wspeed').prop('disabled', false);
                        $('#start').prop('disabled', false);
                        $('#end').prop('disabled', false);
                        $('#accuracy').prop('disabled', false);
                        $('#timer').prop('disabled', false);
                        $('#forecast').prop('disabled', false);
                        $('#weatherprovider').prop('disabled', false);
                    }
                    $('#b-cancel').click(function() {
                        document.location = 'pebblejs://close#';
                    });
                    $('#b-submit').click(function() {
                        document.location = 'pebblejs://close#' + encodeURIComponent(JSON.stringify(saveOptions()));
                    });
                    $('#language').val(getQueryVariable('language')).change();
                    $('#font').val(getQueryVariable('font')).change();
                    $('#gps_switch').val(getQueryVariable('use_gps')).change();
                    $('#location').val(getQueryVariable('location'));
                    if (getQueryVariable('units') == "celsius") {
                        $('input:radio[name=units][value=celsius]').prop('checked', true).trigger("click");
                    } else {
                        $('input:radio[name=units][value=fahrenheit]').prop('checked', true).trigger("click");
                    }
                    $('#invert_color').val(getQueryVariable('invert_color')).change();
                    $('#vibes').val(getQueryVariable('vibes')).change();
                    $('#accuracy').val(getQueryVariable('accuracy')).change();
                    $('#feelslike').val(getQueryVariable('feelslike')).change();
                    $('#ESDuration').val(getQueryVariable('ESDuration')).change();
                    $('#wspeed').val(getQueryVariable('wspeed')).change();
                    $('#start').val(getQueryVariable('start')).change();
                    $('#end').val(getQueryVariable('end')).change();
                    $('#timer').val(getQueryVariable('timer')).change();
                    $('#UUID').val(getQueryVariable('UUID'));
                    $('#lt').val(getQueryVariable('lt'));
                    $('#key').val(getQueryVariable('key'));
                    $('#forecast').val(getQueryVariable('forecast')).change();
                    $('#seconds').val(getQueryVariable('seconds')).change();
                    $('#hourly_vibe').val(getQueryVariable('hourly_vibe')).change();
                    $('#alerts').val(getQueryVariable('alerts')).change();
                    $('#weatherprovider').val(getQueryVariable('weatherprovider')).change();
                    $('#hide_bat').val(getQueryVariable('hide_bat')).change();
                    $('#os0').val(getQueryVariable('UUID'));
                    // Disable location field based on GPS toggle
                    $('#location').prop('disabled', $('#gps_switch').val() == "true");
                    $('#gps_switch').change(function() {
                        $('#location').prop('disabled', $('#gps_switch').val() == "true");
                    });
                });
            </script>
            </body>
        </html>
